/// 722 è¡€å£“ç´€éŒ„è¡¨æ ¼é›™ç”¨ç‰ˆï¼ˆæ•¸ä½+ç´™æœ¬ï¼‰

<!DOCTYPE html>
<html lang="zh-TW">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>722 å±…å®¶è¡€å£“ç´€éŒ„è¡¨ - æ—©å®‰å¥åº·</title>
   <script src="https://cdn.tailwindcss.com"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <style>
       @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');


       body {
           font-family: 'Noto Sans TC', sans-serif;
           background-color: #f3f4f6;
           -webkit-print-color-adjust: exact;
       }


       /* A4 ç´™å¼µæ¨¡æ“¬èˆ‡åˆ—å°è¨­å®š */
       .page {
           width: 210mm;
           min-height: 297mm;
           padding: 15mm;
           margin: 10mm auto;
           background: white;
           box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
           position: relative;
       }


       /* è¡¨æ ¼æ¨£å¼ */
       table {
           width: 100%;
           border-collapse: collapse;
           margin-bottom: 1rem;
       }
      
       th, td {
           border: 1px solid #cbd5e1;
           padding: 6px;
           text-align: center;
           vertical-align: middle;
       }


       th {
           background-color: #78bf22; /* ä¸»è‰² */
           color: white;
           font-weight: bold;
           font-size: 0.9rem;
       }


       .bg-morning { background-color: #ecfccb; } /* æ·ºç¶ åº• */
       .bg-night { background-color: #e0f2fe; } /* æ·ºè—åº• */
      
       /* è¼¸å…¥æ¡†æ¨£å¼ (è®“ç¶²é çœ‹èµ·ä¾†åƒç´™æœ¬) */
       input[type="number"], input[type="text"], input[type="date"] {
           width: 100%;
           border: none;
           background: transparent;
           text-align: center;
           font-size: 1rem;
           color: #333;
           outline: none;
       }


       /* å¹³å‡å€¼æ¬„ä½ */
       .avg-cell {
           font-weight: bold;
           color: #d2672d;
       }


       /* è¢å¹•é¡¯ç¤ºçš„æ“ä½œæŒ‰éˆ•å€ (åˆ—å°æ™‚éš±è—) */
       .action-bar {
           text-align: center;
           margin-bottom: 20px;
       }


       /* åˆ—å°å°ˆç”¨è¨­å®š */
       @media print {
           body { background: none; margin: 0; }
           .page { margin: 0; box-shadow: none; border: none; width: 100%; }
           .action-bar { display: none !important; }
           /* éš±è— placeholder ä»¥ä¾¿æ‰‹å¯« */
           input::placeholder { color: transparent; }
           /* å¼·åˆ¶èƒŒæ™¯è‰²åˆ—å° */
           .bg-morning { background-color: #ecfccb !important; -webkit-print-color-adjust: exact; }
           .bg-night { background-color: #e0f2fe !important; -webkit-print-color-adjust: exact; }
           th { background-color: #78bf22 !important; color: white !important; -webkit-print-color-adjust: exact; }
       }
   </style>
</head>
<body>


   <!-- æ“ä½œæŒ‰éˆ•å€ -->
   <div class="action-bar pt-8">
       <div class="inline-block bg-white p-4 rounded-xl shadow-lg border-t-4 border-[#78bf22]">
           <h3 class="font-bold text-gray-700 mb-2">ä½¿ç”¨èªªæ˜</h3>
           <p class="text-sm text-gray-500 mb-4">ä½ å¯ä»¥ç›´æ¥åœ¨ç¶²é è¼¸å…¥æ•¸å€¼(è‡ªå‹•ç®—å¹³å‡)ï¼Œ<br>æˆ–æ˜¯é»æ“Šåˆ—å°æŒ‰éˆ•ï¼Œå°å‡ºç©ºç™½è¡¨æ ¼æ‰‹å¯«ã€‚</p>
           <button onclick="window.print()" class="bg-[#78bf22] hover:bg-[#6da81e] text-white px-6 py-2 rounded-full font-bold shadow transition flex items-center gap-2 mx-auto">
               <i class="fa-solid fa-print"></i> åˆ—å° / å¦å­˜ PDF
           </button>
       </div>
   </div>


   <!-- A4 é é¢å…§å®¹ -->
   <div class="page">
      
       <!-- è¡¨é ­ -->
       <div class="flex justify-between items-end mb-6 border-b-2 border-[#78bf22] pb-2">
           <div class="flex items-center gap-3">
               <img src="https://media-edh-cdn.h2u.io/image/article/default/w7cymNTKDuTpRSVpyfmx45eU8lr1lbxuGYWpBCO3.png" alt="Logo" class="h-8">
               <div>
                   <h1 class="text-2xl font-bold text-gray-800">722 å±…å®¶è¡€å£“ç´€éŒ„è¡¨</h1>
                   <p class="text-xs text-gray-500">å»ºè­°æ¯ä¸‰å€‹æœˆæˆ–å›è¨ºå‰ï¼Œé€£çºŒæ¸¬é‡ 7 å¤©</p>
               </div>
           </div>
           <div class="text-right">
               <div class="text-sm text-gray-600">
                   å§“åï¼š<input type="text" placeholder="è«‹è¼¸å…¥å§“å" class="border-b border-gray-300 w-32 text-left px-1 focus:border-[#78bf22]">
               </div>
               <div class="text-sm text-gray-600 mt-1">
                   æ—¥æœŸï¼š<input type="date" class="border-b border-gray-300 w-32 text-left px-1 focus:border-[#78bf22]"> è‡³ <input type="date" class="border-b border-gray-300 w-32 text-left px-1 focus:border-[#78bf22]">
               </div>
           </div>
       </div>


       <!-- è¨˜éŒ„è¡¨æ ¼ -->
       <table>
           <thead>
               <tr>
                   <th rowspan="2" style="width: 10%">å¤©æ•¸</th>
                   <th rowspan="2" style="width: 10%">æ™‚æ®µ</th>
                   <th colspan="3">ç¬¬ä¸€æ¬¡æ¸¬é‡</th>
                   <th colspan="3">ç¬¬äºŒæ¬¡æ¸¬é‡ (é–“éš”1åˆ†é˜)</th>
                   <th colspan="2" style="background-color: #d2672d;">å¹³å‡æ•¸å€¼</th>
               </tr>
               <tr>
                   <th class="text-xs">æ”¶ç¸®å£“</th>
                   <th class="text-xs">èˆ’å¼µå£“</th>
                   <th class="text-xs">è„ˆæ</th>
                   <th class="text-xs">æ”¶ç¸®å£“</th>
                   <th class="text-xs">èˆ’å¼µå£“</th>
                   <th class="text-xs">è„ˆæ</th>
                   <th class="text-xs bg-orange-100 text-[#d2672d]">æ”¶ç¸®å£“</th>
                   <th class="text-xs bg-orange-100 text-[#d2672d]">èˆ’å¼µå£“</th>
               </tr>
           </thead>
           <tbody id="recordTable">
               <!-- JS å°‡è‡ªå‹•ç”Ÿæˆ 7 å¤©çš„è¡Œ -->
           </tbody>
       </table>


       <!-- åº•éƒ¨è³‡è¨Š -->
       <div class="mt-6 grid grid-cols-2 gap-6">
           <!-- 722 æé†’ -->
           <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 text-sm">
               <h4 class="font-bold text-[#78bf22] mb-2"><i class="fa-solid fa-circle-info"></i> æ¸¬é‡å°æ’‡æ­¥ (722åŸå‰‡)</h4>
               <ul class="list-disc pl-4 space-y-1 text-gray-600 text-xs">
                   <li><strong>7</strong>ï¼šé€£çºŒæ¸¬é‡ 7 å¤©ã€‚</li>
                   <li><strong>2</strong>ï¼šæ¯å¤©é‡ 2 å›ï¼ˆæ—©ä¸Šèµ·åºŠå¾Œã€æ™šä¸Šç¡è¦ºå‰ï¼‰ã€‚</li>
                   <li><strong>2</strong>ï¼šæ¯å›é‡ 2 æ¬¡ï¼ˆé–“éš” 1 åˆ†é˜ï¼‰ï¼Œå–å¹³å‡å€¼ã€‚</li>
                   <li>æ¸¬é‡å‰ 30 åˆ†é˜ä¸è¸é…’ã€ä¸å–å’–å•¡ã€ä¸é‹å‹•ã€‚</li>
                   <li>æ¸¬é‡æ™‚ä¿æŒå®‰éœã€ä¸èªªè©±ã€ä¸æ†‹å°¿ã€èƒŒé æ¤…èƒŒã€‚</li>
               </ul>
           </div>
          
           <!-- é†«å¸«ç­†è¨˜å€ -->
           <div class="border-2 border-dashed border-gray-300 p-4 rounded-lg">
               <h4 class="font-bold text-gray-400 mb-2">é†«å¸« / è—¥å¸« å»ºè­°æ¬„ï¼š</h4>
               <textarea class="w-full h-24 bg-transparent resize-none outline-none text-gray-600 text-sm" placeholder="(æ­¤è™•ä¾›é†«è­·äººå“¡å¡«å¯«æˆ–åˆ—å°å¾Œæ‰‹å¯«ç­†è¨˜)"></textarea>
           </div>
       </div>


       <div class="text-center mt-8 text-xs text-gray-400">
           &copy; æ—©å®‰å¥åº·å…§å®¹éƒ¨è£½è¡¨ | æ›´å¤šå¥åº·è³‡è¨Šè«‹ä¸Š https://edh.tw
       </div>
   </div>


   <script>
       const tableBody = document.getElementById('recordTable');
       const days = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'];
      
       // ç”Ÿæˆè¡¨æ ¼è¡Œ
       days.forEach((day, index) => {
           // æ—©ä¸Šè¡Œ
           const rowMorning = document.createElement('tr');
           rowMorning.innerHTML = `
               <td rowspan="2" class="font-bold text-gray-500 bg-white">${day}</td>
               <td class="bg-morning text-xs font-bold text-green-800">æ—©ä¸Š â˜€ï¸</td>
               ${generateInputCells(index, 'am', 1)}
               ${generateInputCells(index, 'am', 2)}
               ${generateAvgCells(index, 'am')}
           `;
           tableBody.appendChild(rowMorning);


           // æ™šä¸Šè¡Œ
           const rowNight = document.createElement('tr');
           rowNight.innerHTML = `
               <td class="bg-night text-xs font-bold text-blue-800">æ™šä¸Š ğŸŒ™</td>
               ${generateInputCells(index, 'pm', 1)}
               ${generateInputCells(index, 'pm', 2)}
               ${generateAvgCells(index, 'pm')}
           `;
           tableBody.appendChild(rowNight);
       });


       // ç”Ÿæˆè¼¸å…¥æ ¼ HTML
       function generateInputCells(dayIdx, time, round) {
           const baseId = `d${dayIdx}_${time}_r${round}`;
           return `
               <td><input type="number" id="${baseId}_sys" placeholder="" oninput="calcAvg(${dayIdx}, '${time}')"></td>
               <td><input type="number" id="${baseId}_dia" placeholder="" oninput="calcAvg(${dayIdx}, '${time}')"></td>
               <td><input type="number" id="${baseId}_pul" placeholder=""></td>
           `;
       }


       // ç”Ÿæˆå¹³å‡å€¼æ ¼ HTML
       function generateAvgCells(dayIdx, time) {
           const baseId = `d${dayIdx}_${time}_avg`;
           return `
               <td class="bg-orange-50 avg-cell"><input type="text" id="${baseId}_sys" readonly tabindex="-1"></td>
               <td class="bg-orange-50 avg-cell"><input type="text" id="${baseId}_dia" readonly tabindex="-1"></td>
           `;
       }


       // è‡ªå‹•è¨ˆç®—å¹³å‡å€¼
       function calcAvg(dayIdx, time) {
           const sys1 = parseFloat(document.getElementById(`d${dayIdx}_${time}_r1_sys`).value);
           const sys2 = parseFloat(document.getElementById(`d${dayIdx}_${time}_r2_sys`).value);
           const dia1 = parseFloat(document.getElementById(`d${dayIdx}_${time}_r1_dia`).value);
           const dia2 = parseFloat(document.getElementById(`d${dayIdx}_${time}_r2_dia`).value);


           const avgSysField = document.getElementById(`d${dayIdx}_${time}_avg_sys`);
           const avgDiaField = document.getElementById(`d${dayIdx}_${time}_avg_dia`);


           if (!isNaN(sys1) && !isNaN(sys2)) {
               avgSysField.value = Math.round((sys1 + sys2) / 2);
           } else {
               avgSysField.value = '';
           }


           if (!isNaN(dia1) && !isNaN(dia2)) {
               avgDiaField.value = Math.round((dia1 + dia2) / 2);
           } else {
               avgDiaField.value = '';
           }
       }
   </script>
</body>
</html>

